<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EstarlinHacks - VIP System</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #8e44ad; --dark: #121212; --card: #1e1e1e; --text: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--dark); color: var(--text); margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { background: var(--card); padding: 2rem; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); width: 90%; max-width: 400px; text-align: center; border: 1px solid var(--primary); }
        h2 { color: var(--primary); margin-bottom: 1.5rem; }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: none; background: #2c2c2c; color: white; box-sizing: border-box; }
        button { width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; margin-top: 10px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: #732d91; }
        .btn-payment { background: #f1c40f; color: black; margin-top: 20px; text-decoration: none; display: block; }
        .status-vip { font-size: 1.2rem; margin: 15px 0; padding: 10px; border-radius: 8px; background: rgba(142, 68, 173, 0.2); }
        .hidden { display: none; }
        .admin-section { margin-top: 20px; border-top: 1px dashed #555; padding-top: 15px; }
    </style>
</head>
<body>

    <!-- SECCI칍N LOGIN -->
    <div id="login-section" class="container">
        <h2 id="title-action">Iniciar Sesi칩n</h2>
        <input type="email" id="email" placeholder="Correo Electr칩nico">
        <input type="password" id="password" placeholder="Contrase침a">
        <button class="btn-primary" onclick="handleAuth()">CONTINUAR</button>
        <p onclick="toggleAuth()" style="cursor:pointer; font-size: 0.8rem; margin-top: 15px; color: #bbb;">쯅o tienes cuenta? Reg칤strate aqu칤</p>
    </div>

    <!-- SECCI칍N PANEL DE USUARIO -->
    <div id="user-panel" class="container hidden">
        <h2 onclick="adminClick()">Panel VIP</h2>
        <p id="user-display" style="font-size: 0.9rem; color: #aaa;"></p>
        
        <div class="status-vip">
            Saldo Disponible: <br>
            <strong id="user-balance" style="font-size: 1.5rem; color: #2ecc71;">0</strong> D칤as
        </div>

        <!-- TU LINK DE LEMON SQUEEZY ACTUALIZADO -->
        <button class="btn-payment" onclick="window.open('https://rosaaquinodiaz9.lemonsqueezy.com/checkout/buy/299a610c-6707-4554-b48d-09832dcf129a', '_blank')">
            游 COMPRAR ACCESO VIP
        </button>

        <button onclick="logout()" style="background:transparent; color: #e74c3c; border: 1px solid #e74c3c; margin-top: 20px;">Cerrar Sesi칩n</button>
    </div>

    <!-- SECCI칍N ADMIN (Oculta hasta hacer 5 clics) -->
    <div id="admin-panel" class="container hidden">
        <h2>Panel de Control Admin</h2>
        <input type="email" id="target-email" placeholder="Email del cliente">
        <input type="number" id="add-days" placeholder="D칤as a sumar">
        <button class="btn-primary" onclick="addVipDays()">SUMAR SALDO</button>
        <button onclick="closeAdmin()" style="background:#555; color:white;">Volver al Panel</button>
    </div>

    <script>
        // CONFIGURACI칍N FIREBASE (Usa tus datos aqu칤)
        const firebaseConfig = {
            apiKey: "TU_API_KEY",
            authDomain: "TU_PROYECTO.firebaseapp.com",
            databaseURL: "https://TU_PROYECTO.firebaseio.com",
            projectId: "TU_PROYECTO",
            storageBucket: "TU_PROYECTO.appspot.com",
            messagingSenderId: "TU_ID",
            appId: "TU_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();

        let isLogin = true;
        let clickCount = 0;

        function toggleAuth() {
            isLogin = !isLogin;
            document.getElementById('title-action').innerText = isLogin ? "Iniciar Sesi칩n" : "Crear Cuenta";
        }

        function handleAuth() {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;

            if(isLogin) {
                auth.signInWithEmailAndPassword(email, pass).catch(e => alert(e.message));
            } else {
                auth.createUserWithEmailAndPassword(email, pass).then(userCredential => {
                    db.ref('users/' + userCredential.user.uid).set({ email: email, balance: 0 });
                }).catch(e => alert(e.message));
            }
        }

        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('login-section').classList.add('hidden');
                document.getElementById('user-panel').classList.remove('hidden');
                document.getElementById('user-display').innerText = user.email;
                
                db.ref('users/' + user.uid + '/balance').on('value', snap => {
                    document.getElementById('user-balance').innerText = snap.val() || 0;
                });
            } else {
                document.getElementById('login-section').classList.remove('hidden');
                document.getElementById('user-panel').classList.add('hidden');
                document.getElementById('admin-panel').classList.add('hidden');
            }
        });

        function logout() { auth.signOut(); }

        // SISTEMA DE 5 CLICS PARA EL ADMIN
        function adminClick() {
            clickCount++;
            if(clickCount >= 5) {
                document.getElementById('user-panel').classList.add('hidden');
                document.getElementById('admin-panel').classList.remove('hidden');
                clickCount = 0;
            }
        }

        function closeAdmin() {
            document.getElementById('admin-panel').classList.add('hidden');
            document.getElementById('user-panel').classList.remove('hidden');
        }

        function addVipDays() {
            const email = document.getElementById('target-email').value;
            const days = parseInt(document.getElementById('add-days').value);
            
            db.ref('users').orderByChild('email').equalTo(email).once('value', snap => {
                if(snap.exists()) {
                    const uid = Object.keys(snap.val())[0];
                    const currentBalance = snap.val()[uid].balance || 0;
                    db.ref('users/' + uid).update({ balance: currentBalance + days });
                    alert('Saldo actualizado con 칠xito');
                } else {
                    alert('Usuario no encontrado');
                }
            });
        }
    </script>
</body>
</html>
